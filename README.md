# Python Repository Template

[![Python 3.12][python_badge]](https://www.python.org/downloads/release/python-3120/)
[![License: AGPL v3][agpl3_badge]](https://www.gnu.org/licenses/agpl-3.0)
[![Code Style: Black][black_badge]](https://github.com/ambv/black)

Example Python repository to quickly fork into new clean environment.

- typechecking
- pre-commit

## Weaviate usage

Copy/create the relevant docker filecontent from the [website](https://weaviate.io/developers/weaviate/modules/reader-generator-modules/sum-transformers) into `docker-compose.yml`.

```sh
# Install docker
sudo apt install docker-compose
# Run the first docker-compose file that is given.
docker-compose up -d
# Install weaviate
pip install -U weaviate-client  # For beta versions: `pip install --pre -U "weaviate-client==4.*"`
# Not needed:
#  docker run -p 8080:8080 -p 50051:50051 cr.weaviate.io/semitechnologies/weaviate:1.24.17
```

Then you can use basic Weaviate.

## Clear Weaviate database

Instead of writing a proper delete function, change `QUERY_DEFAULTS_LIMIT: 35` in `docker-compose.yml` and
reinitialise the Weaviate docker with:

```sh
docker-compose up -d
```

## Summation

[Source.](https://weaviate.io/developers/weaviate/modules/reader-generator-modules/sum-transformers) To use the summation feature, you also need to make sure something can do the summation.
To do this, create a file named:

```txt
my-model.Dockerfile
```

with content:

```Dockerfile
FROM semitechnologies/sum-transformers:custom
RUN chmod +x ./download.py
RUN MODEL_NAME=google/pegasus-pubmed ./download.py
```

and run and build it with:

```sh
docker build -f my-model.Dockerfile -t google-pegasus-pubmed .
```

Then you can verify your summation module works, by `UNKNOWN`. You can use this
summation module in other docker files by referring to its tag: `google-pegasus-pubmed`.
I do not yet know how exactly.

## Usage

First install this pip package with:

```bash
pip install pythontemplate
```

Then run:

```sh
python -m src.pythontemplate

```

## Tests

```sh
python -m pytest
```

## Developer

```bash
conda env create --file environment.yml
conda activate pythontemplate

pre-commit install
pre-commit autoupdate
pre-commit run --all
```

## Publish pip package

Install the pip package locally with:

```bash
rm -r build
python -m build
pip install -e .
```

Upload the pip package to the world with:

```bash
rm -r build
python -m build
python3 -m twine upload dist/\*
```

## Sphinx documentation

To generate the documentation ensure the pip package is installed locally, such
that the documentation is able to import its Python files.

```bash
rm -r build
python -m build
pip install -e .
```

Then build the documentation with::

```sh
cd docs
make html
```

You can now see all your auto-generated Sphinx documentation in:
[docs/build/html/index.html](docs/build/html/index.html). This repository
auto-generates the Sphinx documentation for all your Python files using the
[/docs/source/conf.py](/docs/source/conf.py) file.

### Additional manual documentation

- The [docs/source/index.rst](docs/source/index.rst) is autogenerated and
  contains the main page and documentation file-structure.
- You can also add additional manual documentation in Markdown format as files in:

```
docs/source/manual_documenation/your_manual_documentation_filename.md
docs/source/manual_documenation/another_manual_documentation_filename.md
```

and then adding those filepaths into the `docs/source/manual.rst` file like:

```rst
Handwritten Documentation
=========================
.. toctree::
   :maxdepth: 2

   manual_documenation/your_manual_documentation_filename.md
   another_manual_documentation_filename.md
```

<!-- Un-wrapped URL's below (Mostly for Badges) -->

[agpl3_badge]: https://img.shields.io/badge/License-AGPL_v3-blue.svg
[black_badge]: https://img.shields.io/badge/code%20style-black-000000.svg
[python_badge]: https://img.shields.io/badge/python-3.6-blue.svg
